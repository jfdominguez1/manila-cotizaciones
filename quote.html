<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cotizaciones Manila â€” Nueva CotizaciÃ³n</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:ital,wght@0,700;1,400&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- TOP NAV -->
<nav class="topnav">
  <img src="img/logo-manila.png" alt="Manila" class="nav-logo">
  <span class="nav-title">Cotizaciones</span>
  <div class="nav-links">
    <a href="index.html">Dashboard</a>
    <a href="quote.html" class="active">Nueva CotizaciÃ³n</a>
    <a href="history.html">Historial</a>
    <a href="admin.html">Admin</a>
    <a href="seed.html">Datos de ejemplo</a>
  </div>
  <div class="nav-right">
    <span class="nav-user" id="nav-user"></span>
    <button class="btn-logout" id="btn-logout">Salir</button>
  </div>
</nav>

<!-- MAIN LAYOUT -->
<div class="quote-layout">

  <!-- PANEL IZQUIERDO -->
  <aside class="quote-panel">

    <div class="panel-header">
      <h2>Nueva CotizaciÃ³n</h2>
      <span class="quote-number" id="panel-quote-number">â€”</span>
    </div>

    <!-- Producto -->
    <div class="panel-section">
      <h3>Producto</h3>
      <div class="product-selector">
        <div class="product-thumb-placeholder" id="product-thumb-wrap"><span>ðŸ“¦</span></div>
        <div style="flex:1">
          <select id="product-select" style="width:100%;padding:7px 10px;border:1px solid var(--gray-200);border-radius:6px;font-size:13px;font-family:var(--font);outline:none;color:var(--carbon)">
            <option value="">â€” Seleccionar producto â€”</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Marca -->
    <div class="panel-section">
      <h3>Marca</h3>
      <div class="brand-switcher" id="brand-switcher">
        <button class="brand-btn" data-brand="manila">Manila<br>S.A.</button>
        <button class="brand-btn active" data-brand="patagonia">Patagonia<br>Exquisiteces</button>
        <button class="brand-btn" data-brand="andes">Andes<br>Natural Fish</button>
      </div>
    </div>

    <!-- Cliente -->
    <div class="panel-section">
      <h3>Cliente</h3>
      <div class="form-row">
        <label>Nombre / Empresa</label>
        <input type="text" id="client-name" placeholder="Distribuidor XYZ...">
      </div>
      <div class="form-row-2col">
        <div>
          <label>PaÃ­s destino</label>
          <input type="text" id="client-country" placeholder="USA">
        </div>
        <div>
          <label>Contacto</label>
          <input type="text" id="client-contact" placeholder="John Smith">
        </div>
      </div>
      <div class="form-row">
        <label>Ciudad / Puerto de destino</label>
        <input type="text" id="client-dest-port" placeholder="Miami, FL â€” USA">
      </div>
    </div>

    <!-- OperaciÃ³n -->
    <div class="panel-section">
      <h3>OperaciÃ³n</h3>
      <div class="form-row">
        <label>Incoterm</label>
        <select id="incoterm-select">
          <option value="">â€” Seleccionar â€”</option>
        </select>
      </div>
      <div class="form-row">
        <label>Puerto / Ciudad de origen</label>
        <input type="text" id="origin-port" placeholder="Buenos Aires, Argentina">
      </div>
      <div class="form-row">
        <label>Tipo de envÃ­o</label>
        <select id="transport-type">
          <option value="">â€” Seleccionar â€”</option>
          <option value="MarÃ­timo">MarÃ­timo</option>
          <option value="AÃ©reo">AÃ©reo</option>
          <option value="Terrestre">Terrestre</option>
          <option value="MarÃ­timo Refrigerado">MarÃ­timo Refrigerado</option>
          <option value="AÃ©reo Refrigerado">AÃ©reo Refrigerado</option>
        </select>
      </div>
      <div class="form-row-2col">
        <div>
          <label>Volumen total (kg)</label>
          <input type="number" id="volume-kg" placeholder="10000" min="1" step="1">
        </div>
        <div>
          <label>NÂ° de embarques</label>
          <input type="number" id="num-shipments" value="1" min="1" step="1">
        </div>
      </div>
      <div class="form-row-2col">
        <div>
          <label>Rendimiento (%)</label>
          <input type="number" id="yield-pct" placeholder="50" min="1" max="100" step="0.1">
        </div>
        <div>
          <label>Validez (dÃ­as)</label>
          <input type="number" id="valid-days" value="15" min="1">
        </div>
      </div>
      <div class="form-row">
        <label>Lead time</label>
        <input type="text" id="lead-time" placeholder="7-10 dÃ­as desde confirmaciÃ³n">
      </div>
    </div>

    <!-- Propuesta PDF -->
    <div class="panel-section">
      <h3>Propuesta al cliente</h3>
      <div class="form-row" id="cert-picker-wrap" style="display:none">
        <label>Certificaciones a mostrar</label>
        <div class="cert-checkboxes" id="cert-picker"></div>
      </div>
      <div class="form-row">
        <label>Comentarios / condiciones para el cliente</label>
        <textarea id="client-comments" placeholder="Condiciones de pago, packaging especial, notas de la oferta..." style="min-height:72px"></textarea>
      </div>
      <div class="form-row">
        <label>Notas internas (no aparecen en PDF)</label>
        <textarea id="quote-notes" placeholder="Observaciones internas, contexto de la negociaciÃ³n..."></textarea>
      </div>
    </div>

    <!-- Resumen de costos -->
    <div class="panel-section">
      <h3>Resumen de costos</h3>
      <div class="cost-summary" id="cost-summary"></div>
      <div class="margin-row">
        <label>Margen</label>
        <input type="number" id="margin-pct" value="20" min="0" max="100" step="0.1">
        <span class="margin-hint">%</span>
      </div>
      <div class="margin-row target-price-row">
        <label>Precio objetivo</label>
        <input type="number" id="target-price" placeholder="â€”" min="0" step="0.01">
        <span class="margin-hint">USD/kg</span>
      </div>
      <div class="price-highlight" id="price-highlight">
        <div class="price-label">Precio de venta</div>
        <div class="price-both">
          <span class="price-kg" id="price-kg">USD â€”</span>
          <span class="price-sep">Â·</span>
          <span class="price-lb" id="price-lb">â€” /lb</span>
        </div>
      </div>
    </div>

    <!-- Acciones -->
    <div class="panel-actions">
      <button class="btn-primary" id="btn-confirm" disabled>Confirmar cotizaciÃ³n</button>
      <button class="btn-secondary" id="btn-save-draft">Guardar borrador</button>
      <div style="display:flex;gap:8px">
        <button class="btn-secondary" id="btn-print-client" disabled style="flex:1">PDF Cliente</button>
        <button class="btn-secondary" id="btn-print-internal" disabled style="flex:1">PDF Costos</button>
      </div>
    </div>

  </aside>

  <!-- COLUMNA DERECHA: CAPAS DE COSTO -->
  <main class="quote-layers" id="layers-container"></main>

</div>

<!-- ============================================================
     PDF: PRINT ONLY
     ============================================================ -->
<div class="pdf-container" id="pdf-container">

  <!-- PÃGINA 1: INTERNA (costos) â€” imprime primero en PDF Costos -->
  <div class="pdf-page pdf-internal-page" id="pdf-internal-page">
    <div class="pdf-internal-title">
      <span>Detalle de costos â€” <span id="pdf-int-quote-number"></span></span>
      <span class="int-sub">USO INTERNO MANILA S.A. â€” CONFIDENCIAL</span>
    </div>
    <table class="pdf-cost-table" id="pdf-cost-table">
      <thead>
        <tr>
          <th>Concepto</th>
          <th>Fuente</th>
          <th class="num">Valor original</th>
          <th class="num">Fijo/emb.</th>
          <th class="num">Fijo/coti.</th>
          <th class="num">$/kg</th>
        </tr>
      </thead>
      <tbody id="pdf-cost-tbody"></tbody>
    </table>
    <div class="pdf-cost-breakdown" id="pdf-cost-breakdown"></div>
    <div class="pdf-summary-box">
      <div class="sum-cell">
        <div class="sum-label">Costo total</div>
        <div class="sum-val" id="pdf-sum-cost"></div>
        <div class="sum-sub">USD/kg</div>
      </div>
      <div class="sum-cell">
        <div class="sum-label">Margen aplicado</div>
        <div class="sum-val" id="pdf-sum-margin"></div>
        <div class="sum-sub">%</div>
      </div>
      <div class="sum-cell">
        <div class="sum-label">Precio final</div>
        <div class="sum-val" id="pdf-sum-price"></div>
        <div class="sum-sub" id="pdf-sum-price-lb"></div>
      </div>
    </div>
    <div class="pdf-meta-footer" id="pdf-meta-footer"></div>
  </div>

  <!-- PÃGINA 2: CLIENTE â€” sola en PDF Cliente, segunda en PDF Costos -->
  <div class="pdf-page pdf-client-page" id="pdf-client-page">

    <!-- InscripciÃ³n visible solo en PDF Costos (modo internal) -->
    <div class="pdf-copy-label">COPIA ENVIADA AL CLIENTE</div>

    <!-- Header: logos sobre la lÃ­nea -->
    <div class="pdf-header">
      <img id="pdf-logo" src="img/logo-manila.png" alt="Manila" class="pdf-brand-logo">
      <img id="pdf-manila-logo-small" src="img/logo-manila.png" alt="Manila S.A." class="pdf-manila-small">
    </div>

    <!-- Barra de datos debajo de la lÃ­nea -->
    <div class="pdf-quote-bar">
      <div class="pdf-quote-number" id="pdf-quote-number">â€”</div>
      <div class="pdf-quote-meta">
        <span id="pdf-date"></span>
        <span id="pdf-valid"></span>
      </div>
    </div>

    <!-- Foto del producto (siempre visible, fallback de color) -->
    <div class="pdf-photo-wrap" id="pdf-photo-wrap">
      <img id="pdf-product-img" src="" alt="" class="pdf-product-photo">
    </div>

    <!-- Nombre + specs del producto -->
    <div class="pdf-product-block">
      <div class="pdf-product-name" id="pdf-product-name"></div>
      <div class="pdf-product-spec" id="pdf-product-spec"></div>
    </div>

    <!-- Info grid: todos los datos del envÃ­o -->
    <div class="pdf-info-grid" id="pdf-info-grid">
      <div class="pdf-info-cell">
        <div class="cell-label">To</div>
        <div class="cell-val" id="pdf-client-val"></div>
      </div>
      <div class="pdf-info-cell">
        <div class="cell-label">Destination</div>
        <div class="cell-val" id="pdf-dest-val"></div>
      </div>
      <div class="pdf-info-cell">
        <div class="cell-label">From</div>
        <div class="cell-val">Manila S.A. â€” Bariloche, Argentina</div>
      </div>
      <div class="pdf-info-cell">
        <div class="cell-label" id="pdf-origin-label">Port of Origin</div>
        <div class="cell-val" id="pdf-origin-val"></div>
      </div>
      <div class="pdf-info-cell">
        <div class="cell-label">Transport</div>
        <div class="cell-val" id="pdf-transport-val"></div>
      </div>
      <div class="pdf-info-cell">
        <div class="cell-label">Volume</div>
        <div class="cell-val" id="pdf-volume-val"></div>
      </div>
      <div class="pdf-info-cell">
        <div class="cell-label">Lead Time</div>
        <div class="cell-val" id="pdf-leadtime-val"></div>
      </div>
      <div class="pdf-info-cell">
        <div class="cell-label">Valid Until</div>
        <div class="cell-val" id="pdf-validuntil-val"></div>
      </div>
    </div>

    <!-- Certificaciones (solo las seleccionadas) -->
    <div class="pdf-certs" id="pdf-certs"></div>

    <!-- Comentarios para el cliente -->
    <div class="pdf-comments" id="pdf-comments" style="display:none">
      <div class="pdf-comments-label">Notes & Conditions</div>
      <div class="pdf-comments-text" id="pdf-comments-text"></div>
    </div>

    <!-- Precio al final: kg y lb al mismo nivel -->
    <div class="pdf-price-block" id="pdf-price-block">
      <div class="pdf-incoterm-label" id="pdf-incoterm-label"></div>
      <div class="pdf-prices-row">
        <div class="pdf-price-unit">
          <span class="pdf-price-val" id="pdf-price-main">â€”</span>
          <span class="pdf-price-unit-label">USD / kg</span>
        </div>
        <div class="pdf-price-divider">|</div>
        <div class="pdf-price-unit">
          <span class="pdf-price-val" id="pdf-price-lb-val">â€”</span>
          <span class="pdf-price-unit-label">USD / lb</span>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="pdf-footer">
      <span>Manila S.A. â€” Bariloche, RÃ­o Negro, Patagonia Argentina</span>
      <span>info@manilapatagonia.com Â· www.manilapatagonia.com</span>
    </div>
  </div>

</div>

<script type="module" src="js/quote.js"></script>
</body>
</html>
